<!DOCTYPE html>
<html lang="en">
  <head>
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  </head>
  <body >
  </body>
</html>
<script type ='text/javascript'>

// 'use strict';

// // ajax函数将返回Promise对象:
// function ajax(method, url, data) {
//     var request = new XMLHttpRequest();
//     return new Promise(function (resolve, reject) {
//         request.onreadystatechange = function () {
//             if (request.readyState === 4) {
//                 if (request.status === 200) {
//                     resolve(request.responseText);
//                 } else {
//                     reject(request.status);
//                 }
//             }
//         };
//         request.open(method, url);
//         request.send(data);
//     });
// }

// var log = document.body;
// var p = ajax('GET', 'https://www.tianqiapi.com/api/');
// p.then(function (text) { // 如果AJAX成功，获得响应内容
//     log.innerText = text;
// }).catch(function (status) { // 如果AJAX失败，获得响应代码
//     log.innerText = 'ERROR: ' + status;
// });


// //问题2 Promise.all
// var p1 = new Promise(function (resolve, reject) {
//     setTimeout(resolve, 500, 'P1');
// });
// var p2 = new Promise(function (resolve, reject) {
//     setTimeout(resolve, 600, 'P2');
// });
// // 同时执行p1和p2，并在它们都完成后执行then:
// Promise.all([p1, p2]).then(function (results) {
//     console.log(results); // 获得一个Array: ['P1', 'P2']
// });

// //问题3 race
// var p1 = new Promise(function (resolve, reject) {
//     setTimeout(resolve, 500, 'P1');
// });
// var p2 = new Promise(function (resolve, reject) {
//     setTimeout(resolve, 600, 'P2');
// });
// Promise.race([p1, p2]).then(function (result) {
//     console.log(result); // 'P1'
// });


var promise = new Promise(function(resolve, reject){ 
     setTimeout(function(){        
      throw new Error('test')    
     }, 0)    
     resolve('ok'); 
     //输出     
});
promise.then(
  function(value){ console.log(value) }
)
.catch(()=> console.log('err'))

</script>
